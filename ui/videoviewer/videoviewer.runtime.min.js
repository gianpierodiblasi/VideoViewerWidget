$("head").append('<link href="../Common/extensions/VideoWidget/ui/videoviewer/jslibrary/video-js.css" rel="stylesheet">');$("body").append('<script type="text/javascript" src="../Common/extensions/VideoWidget/ui/videoviewer/jslibrary/video.js">\x3c/script>');
document.addEventListener("fullscreenchange",function(){$(".widget-videoviewer .video-js .vjs-control-bar").each(function(){var b=310>$(this).width()?"none":"flex";$(".vjs-volume-panel",this).css("display",b);$(".vjs-progress-control",this).css("display",b);$(".vjs-remaining-time",this).css("display",b)})});
TW.Runtime.Widgets.videoviewer=function(){var b=this,d=(new Date).getTime()+"_"+Math.floor(1E3*Math.random());this.runtimeProperties=function(){return{supportsAutoResize:!0,needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-videoviewer widget-videoviewer-'+d+'"></div>'};this.afterRender=function(){};this.resize=function(a,b){};this.serviceInvoked=function(a){if("Load"===a){$(".widget-videoviewer-"+d).empty();a=b.getProperty("url");var e=b.getProperty("videoJS"),
g=b.getProperty("srcMode"),f=b.getProperty("autoplay"),c=b.getProperty("debugMode");c&&console.log("VideoViewer - Load -> url = "+a+", videoJS = "+e+", srcMode = "+g+", autoplay = "+f);switch(g){case "URL":b.createVideoTag(a,"",e,f);break;case "BASE64":b.loadVideo(a,e,f,c)}}};this.createVideoTag=function(a,e,g,f){var c=d+"_"+Math.floor(1E3*Math.random());g?($('<video id="widget-videoviewer-'+c+'" class="video-js" controls preload="auto"></video>').append('<source src="'+a+'" type="'+e+'"></source>').appendTo($(".widget-videoviewer-"+
d)),videojs("widget-videoviewer-"+c,{fluid:!0},function(){b.jqElement.triggerHandler("Loaded");var a=310>$(".widget-videoviewer-"+d+" .video-js .vjs-control-bar").width()?"none":"flex";$(".widget-videoviewer-"+d+" .video-js .vjs-control-bar .vjs-volume-panel").css("display",a);$(".widget-videoviewer-"+d+" .video-js .vjs-control-bar .vjs-progress-control").css("display",a);$(".widget-videoviewer-"+d+" .video-js .vjs-control-bar .vjs-remaining-time").css("display",a);f&&this.play()})):$('<video id="widget-videoviewer-'+
c+'" class="widget-videoviewer-video" controls preload="auto"'+(f?" autoplay":"")+"></video>").append('<source src="'+a+'" type="'+e+'"></source>').appendTo($(".widget-videoviewer-"+d))};this.loadVideo=function(a,d,g,f){var c=new XMLHttpRequest;c.open("GET",a);c.responseType="arraybuffer";c.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var a=this.getResponseHeader("Content-Type"),c="";(new Uint8Array(this.response)).forEach(a=>c+=String.fromCharCode(a));var e="data:"+
a+";base64,"+btoa(c);b.createVideoTag(e,a,d,g)}else f&&console.log("VideoViewer - error"),b.jqElement.triggerHandler("Failed")};c.send()};this.updateProperty=function(a){"url"===a.TargetProperty?this.setProperty("url",a.RawSinglePropertyValue):"autoplay"===a.TargetProperty?this.setProperty("autoplay",a.RawSinglePropertyValue):"videoJS"===a.TargetProperty?this.setProperty("videoJS",a.RawSinglePropertyValue):"srcMode"===a.TargetProperty&&this.setProperty("srcMode",a.RawSinglePropertyValue)}};